<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Netiquette Dashboard</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/light-bootstrap-dashboard.css?v=2.0.1" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="" />
  </head>
  <body>
    <div class="wrapper">
      <div class="sidebar" data-color="blue">
        <div class="sidebar-wrapper">
          <div class="logo"><span class="simple-text">Netiquette</span></div>
          <div class="nq-navbar"></div>
        </div>
      </div>
      <div class="main-panel">
        <nav class="navbar navbar-expand-lg" color-on-scroll="500">
          <div class=" container-fluid">
            <span class="navbar-brand"> Netiquette Underwater Networking Testbed @ SJI </span>
            <button href="" class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-bar burger-lines"></span>
              <span class="navbar-toggler-bar burger-lines"></span>
              <span class="navbar-toggler-bar burger-lines"></span>
            </button>
          </div>
        </nav>
        <div class="content">
          <div class="container-fluid">
            <div class="card-body">
              <div class="row">
                <div class="col-md-10">
                  <div id="mapid" style="height: 600px;"></div>
                </div>
                <div class="col-md-2">
                  <h5><b>Component Status</b></h5>
                  <hr />
                  <div class="badge badge-pill badge-success">HQ</div><br />
                  <div class="badge badge-pill badge-success">AIS</div><br />
                  <hr />
                  <div class="badge badge-pill badge-success">Node A</div><br />
                  <div class="badge badge-pill badge-success">Modem 42</div><br />
                  <div class="badge badge-pill badge-success">Weather station</div><br />
                  <div class="badge badge-pill badge-secondary">ADP</div><br />
                  <hr />
                  <div class="badge badge-pill badge-success">Node B</div><br />
                  <div class="badge badge-pill badge-success">Modem 43</div><br />
                  <div class="badge badge-pill badge-danger" >ADP</div><br />
                  <hr />
                  <div class="badge badge-pill badge-success">Node C</div><br />
                  <div class="badge badge-pill badge-success">PV Battery</div><br />
                  <div class="badge badge-pill badge-success">Modem 44</div><br />
                  <div class="badge badge-pill badge-success">GPS</div><br />
                  <div class="badge badge-pill badge-secondary">ADP</div><br />
                </div>
              </div>
            </div>
          </div>
        </div>
        <footer class="footer">
          <div class="container">
            <nav>
              <p class="copyright text-center">
                &copy;
                <script>document.write(new Date().getFullYear())</script>
                <a href="http://arl.nus.edu.sg">Acoustic Research Laboratory</a>,
                <a href="http://www.nus.edu.sg">National University of Singapore</a>.
              </p>
            </nav>
          </div>
        </footer>
      </div>
    </div>
  </body>
  <script src="assets/js/core/jquery.3.2.1.min.js" type="text/javascript"></script>
  <script src="assets/js/core/popper.min.js" type="text/javascript"></script>
  <script src="assets/js/core/bootstrap.min.js" type="text/javascript"></script>
  <script src="assets/js/plugins/chartist.min.js" type="text/javascript"></script>
  <script src="assets/js/light-bootstrap-dashboard.js?v=2.0.1" type="text/javascript"></script>
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
   integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
   crossorigin=""></script>
  <script src="assets/js/nq-dashboard.js" type="text/javascript"></script>
  <script type="text/javascript">
    var mymap = L.map('mapid').setView([1.213560, 103.854016], 16);
    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
      maxZoom: 18,
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
        '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
        'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
      id: 'mapbox.streets'
    }).addTo(mymap);
    L.marker([1.21581, 103.85081]).bindTooltip('<b>HQ:</b><br>AIS').addTo(mymap);
    L.marker([1.21705, 103.85190]).bindTooltip('<b>Node A:</b><br>Modem 42<br>Weather station<br>ADP').addTo(mymap);
    L.marker([1.21371, 103.85225]).bindTooltip('<b>Node B:</b><br>Modem 43<br>ADP').addTo(mymap);
    L.marker([1.21708, 103.85666]).bindTooltip('<b>Node C:</b><br>(PV powered)<br>Modem 44<br>ADP').addTo(mymap);
    $.ajax({
      url: 'https://raw.githubusercontent.com/org-arl/netiquette-dashboard/hq/data/aisTracks.json',
      dataType: 'application/json',
      complete: function(data) {
        if (data.status == 200) {
          data = JSON.parse(data['responseText']);
          var values = Object.keys(data).map(function(key) { return data[key]; });
          L.polyline(values, {color: '#d0d0d0', weight: 1}).addTo(mymap);
          for (var mssi in data) {
            L.circleMarker(data[mssi][data[mssi].length-1], {color: 'white', radius: 3}).bindPopup('<a href="https://www.marinetraffic.com/en/ais/details/ships/mmsi:'+mssi+'" target="_blank">MSSI: '+mssi+'</a>').addTo(mymap);
          }
        }
      }
    })
  </script>
</html>
